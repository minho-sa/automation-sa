# IAM

### 1. 루트 계정 액세스 키 검사
- **조건**: 루트 계정에 액세스 키가 존재할 때
- **심각도**: 높음
- **메시지**: "루트 계정 액세스 키 제거가 필요합니다."
- **문제점**: "루트 계정에 액세스 키가 활성화되어 있습니다."
- **영향**: "루트 계정 자격 증명 노출 시 계정 전체에 대한 무제한 액세스 위험이 있습니다."
- **혜택**: "루트 계정 보안 강화 및 잠재적 보안 위협 감소가 가능합니다."
- **권장 조치**:
  - 루트 계정 액세스 키를 즉시 삭제합니다.
  - 필요한 작업은 IAM 사용자 또는 역할을 통해 수행합니다.
  - 루트 계정에는 MFA를 활성화합니다.
  - 루트 계정은 긴급 상황에만 사용합니다.

### 2. MFA 미설정 사용자 검사
- **조건**: IAM 사용자에게 MFA가 설정되어 있지 않을 때
- **심각도**: 높음
- **메시지**: "MFA 미설정 사용자가 존재합니다."
- **문제점**: "{user_count}명의 사용자가 MFA를 설정하지 않았습니다."
- **영향**: "자격 증명 도용 위험이 증가하고 계정 보안이 취약한 상태입니다."
- **혜택**: "MFA 설정으로 무단 액세스 위험을 95% 이상 감소시킬 수 있습니다."
- **권장 조치**:
  - 모든 IAM 사용자에게 MFA 설정을 의무화합니다.
  - MFA 미설정 사용자에 대한 액세스 제한 정책을 적용합니다.
  - 정기적인 MFA 설정 상태를 모니터링합니다.
  - MFA 설정 가이드를 사용자에게 제공합니다.

### 3. 미사용 IAM 자격 증명 검사
- **조건**: 90일 이상 사용되지 않은 IAM 자격 증명이 있을 때
- **심각도**: 중간
- **메시지**: "미사용 IAM 자격 증명 정리가 필요합니다."
- **문제점**: "{credential_count}개의 자격 증명이 {days}일 동안 사용되지 않았습니다."
- **영향**: "불필요한 액세스 포인트로 인한 보안 위험이 증가하고 있습니다."
- **혜택**: "미사용 자격 증명 제거로 보안 태세 강화 및 관리 부담 감소가 가능합니다."
- **권장 조치**:
  - 90일 이상 사용되지 않은 액세스 키를 비활성화합니다.
  - 180일 이상 사용되지 않은 액세스 키를 삭제합니다.
  - 미사용 IAM 사용자 계정을 비활성화합니다.
  - 정기적인 자격 증명 감사를 수행합니다.

### 4. IAM 정책 권한 검사
- **조건**: 과도한 권한(Admin 또는 *:*)이 부여된 정책이 있을 때
- **심각도**: 높음
- **메시지**: "과도한 IAM 권한 검토가 필요합니다."
- **문제점**: "{policy_count}개의 정책에 과도한 권한이 부여되어 있습니다."
- **영향**: "최소 권한 원칙 위반으로 보안 위험이 증가하고 있습니다."
- **혜택**: "최소 권한 원칙 적용으로 보안 강화 및 잠재적 위험 감소가 가능합니다."
- **권장 조치**:
  - 관리형 정책 대신 사용자 지정 정책을 사용합니다.
  - 와일드카드(*) 사용을 최소화합니다.
  - IAM Access Analyzer를 활용하여 정책을 검토합니다.
  - 정기적인 권한 감사를 수행합니다.

### 5. IAM 역할 신뢰 관계 검사
- **조건**: 외부 계정에 과도한 권한을 부여하는 신뢰 관계가 있을 때
- **심각도**: 높음
- **메시지**: "IAM 역할 신뢰 관계 검토가 필요합니다."
- **문제점**: "{role_count}개의 역할이 외부 계정에 과도한 권한을 부여하고 있습니다."
- **영향**: "의도하지 않은 계정 간 액세스로 인한 보안 위험이 증가하고 있습니다."
- **혜택**: "적절한 신뢰 관계 설정으로 계정 간 보안 강화가 가능합니다."
- **권장 조치**:
  - 모든 역할의 신뢰 관계를 검토합니다.
  - 외부 계정에 대한 액세스를 제한합니다.
  - 조건부 신뢰 관계를 구성합니다.
  - 정기적인 신뢰 관계 감사를 수행합니다.

### 6. IAM 사용자 직접 정책 연결 검사
- **조건**: IAM 사용자에게 직접 정책이 연결되어 있을 때
- **심각도**: 중간
- **메시지**: "IAM 사용자 권한 관리 개선이 필요합니다."
- **문제점**: "{user_count}명의 사용자에게 직접 정책이 연결되어 있습니다."
- **영향**: "권한 관리의 복잡성이 증가하고 일관성이 저하되고 있습니다."
- **혜택**: "그룹 기반 권한 관리로 효율성 향상 및 관리 부담 감소가 가능합니다."
- **권장 조치**:
  - IAM 그룹을 생성하고 사용자를 그룹에 할당합니다.
  - 정책을 그룹에 연결합니다.
  - 사용자에게 직접 연결된 정책을 제거합니다.
  - 정기적인 권한 구조를 검토합니다.

### 7. 액세스 키 교체 검사
- **조건**: 액세스 키가 90일 이상 교체되지 않았을 때
- **심각도**: 중간
- **메시지**: "액세스 키 교체가 필요합니다."
- **문제점**: "{key_count}개의 액세스 키가 {days}일 동안 교체되지 않았습니다."
- **영향**: "장기간 사용된 자격 증명으로 인한 보안 위험이 증가하고 있습니다."
- **혜택**: "정기적인 자격 증명 교체로 보안 강화가 가능합니다."
- **권장 조치**:
  - 90일마다 액세스 키를 교체합니다.
  - 액세스 키 교체 일정을 수립합니다.
  - 자동화된 키 교체 메커니즘을 구현합니다.
  - 키 교체 상태를 모니터링합니다.

### 8. 비밀번호 정책 검사
- **조건**: 계정 비밀번호 정책이 AWS 권장 설정보다 약할 때
- **심각도**: 중간
- **메시지**: "계정 비밀번호 정책 강화가 필요합니다."
- **문제점**: "현재 비밀번호 정책이 AWS 권장 설정보다 약합니다."
- **영향**: "약한 비밀번호로 인한 계정 침해 위험이 증가하고 있습니다."
- **혜택**: "강력한 비밀번호 정책으로 무단 액세스 위험 감소가 가능합니다."
- **권장 조치**:
  - 최소 14자 이상의 비밀번호 길이를 설정합니다.
  - 대문자, 소문자, 숫자, 특수 문자를 요구합니다.
  - 90일 이하의 비밀번호 만료 기간을 설정합니다.
  - 비밀번호 재사용을 제한합니다.

### 9. 서비스 연결 역할 사용 검사
- **조건**: AWS 서비스를 사용하지만 서비스 연결 역할을 사용하지 않을 때
- **심각도**: 낮음
- **메시지**: "서비스 연결 역할 사용 검토가 필요합니다."
- **문제점**: "{service_count}개의 서비스가 서비스 연결 역할을 사용하지 않고 있습니다."
- **영향**: "수동 권한 관리로 인한 관리 부담 및 오류 가능성이 증가하고 있습니다."
- **혜택**: "서비스 연결 역할 사용으로 권한 관리 간소화 및 오류 감소가 가능합니다."
- **권장 조치**:
  - 지원되는 서비스에 서비스 연결 역할을 활성화합니다.
  - 기존 수동 관리 역할을 서비스 연결 역할로 마이그레이션합니다.
  - 서비스 연결 역할 사용 현황을 모니터링합니다.
  - AWS 서비스 권한 관리 방식을 정기적으로 검토합니다.
