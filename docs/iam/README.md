# IAM (Identity and Access Management)

### 1. 사용자 수 관리 검사
- **조건**: 계정 내 IAM 사용자 수가 15명 이상일 때
- **심각도**: 높음
- **추천 메시지**: "현재 계정에 {user_count}명의 IAM 사용자가 있습니다. 미사용 계정을 정기적으로 검토하고 제거하세요."
- **문제점**: 다수의 IAM 사용자는 보안 위험을 증가시키고 계정 관리를 복잡하게 만듭니다.
- **권장 조치**:
  - AWS 콘솔에서 IAM 서비스로 이동
  - 각 사용자의 마지막 활동 시간 확인
  - 90일 이상 활동이 없는 사용자 식별
  - 필요하지 않은 사용자 비활성화 또는 삭제
  - 나머지 사용자에 대해 최소 권한 원칙 적용

### 2. MFA 활성화 검사
- **조건**: 콘솔 액세스가 가능한 사용자(password_enabled=True)이며 MFA가 비활성화된 경우
- **심각도**: 높음
- **추천 메시지**: "사용자 {username}에 대해 MFA 활성화가 필요합니다."
- **문제점**: MFA가 설정되지 않은 계정은 비인가 접근에 취약합니다.
- **권장 조치**:
  - AWS 콘솔에서 IAM 서비스로 이동
  - 해당 사용자 선택
  - 보안 자격 증명 탭으로 이동
  - MFA 디바이스 할당
  - 가상 MFA 또는 하드웨어 MFA 설정

### 3. 액세스 키 관리 검사
- **조건**: 다음 중 하나 이상 해당
  - 생성된 지 90일 이상된 액세스 키 존재
  - 30일 이상 사용되지 않은 액세스 키 존재
- **심각도**: 중간
- **추천 메시지**: "사용자 {username}의 액세스 키 관리가 필요합니다."
- **문제점**: 오래되거나 미사용 중인 액세스 키는 보안 위험을 초래할 수 있습니다.
- **권장 조치**:
  - AWS 콘솔에서 IAM 서비스로 이동
  - 해당 사용자 선택
  - 보안 자격 증명 탭에서 액세스 키 확인
  - 필요한 경우 새로운 액세스 키 생성
  - 이전 키 비활성화 및 일정 기간 후 삭제

### 4. 권한 경계 설정 검사
- **조건**: 다음 중 하나 이상 해당하는 관리자 권한 사용자 존재
  - 관리자 그룹(Administrators, Admin, PowerUsers 등) 소속
  - 관리자 정책(AdministratorAccess, IAMFullAccess 등) 보유
  - 전체 권한 정책(Action: *, Resource: *) 보유
- **심각도**: 중간
- **추천 메시지**: "관리자 권한을 가진 사용자에 대한 권한 경계 설정이 필요합니다."
- **문제점**: 권한 경계가 없으면 관리자 권한을 가진 사용자가 의도하지 않게 과도한 권한을 행사할 수 있습니다.
- **권장 조치**:
  - AWS 콘솔에서 IAM 서비스로 이동
  - 적절한 권한 경계 정책 생성
  - 식별된 관리자 사용자들에게 권한 경계 적용
  - 정기적으로 권한 경계 설정 검토

### 5. 비밀번호 정책 검사
- **조건**: 계정 내에 콘솔 액세스가 가능한 사용자가 존재할 때
- **심각도**: 중간
- **추천 메시지**: "계정의 비밀번호 정책을 강화하세요."
- **문제점**: 약한 비밀번호 정책은 보안 위험을 초래할 수 있습니다.
- **권장 조치**:
  - 최소 14자 이상의 비밀번호 길이 요구
  - 대문자, 소문자, 숫자, 특수문자 포함 설정
  - 비밀번호 재사용 제한
  - 90일마다 비밀번호 변경 요구
  - 이전 비밀번호 재사용 방지