# EC2 서비스 어드바이저 검사항목 분석

## 개요
EC2 서비스 어드바이저는 Amazon EC2 인스턴스와 관련 리소스의 보안, 성능, 비용 최적화를 위한 검사를 수행합니다.

## 검사항목 목록

### 1. 보안 그룹 설정 검사 (ec2-security-group)

#### 검사 목적
- **주요 목적**: 과도하게 개방된 보안 그룹 규칙으로 인한 보안 위험 식별
- **보안 위험**: 0.0.0.0/0과 같은 광범위한 CIDR 블록에 대한 SSH, RDP, 데이터베이스 포트 개방

#### 심각도 기준: HIGH
**HIGH로 설정한 이유:**
1. **직접적인 보안 위험**: 인터넷에서 직접 접근 가능한 중요 포트는 즉각적인 보안 위협
2. **공격 빈도**: SSH(22), RDP(3389) 포트는 가장 빈번하게 공격받는 대상
3. **영향 범위**: 한 번의 침해로 전체 인스턴스가 위험에 노출
4. **복구 난이도**: 침해 발생 시 시스템 전체 재구축이 필요할 수 있음

#### 검사 기준
- **FAIL 조건**:
  - SSH 포트(22)가 0.0.0.0/0에 개방
  - RDP 포트(3389)가 0.0.0.0/0에 개방
  - 데이터베이스 포트(3306, 5432)가 인터넷에 노출
  - 모든 포트(0-65535)가 개방된 경우

#### 권장 개선 방안
1. **특정 IP 제한**: 관리자 IP 주소로만 SSH/RDP 접근 제한
2. **VPN/배스천 호스트**: 직접 접근 대신 중간 서버를 통한 접근
3. **포트 변경**: 기본 포트 대신 사용자 정의 포트 사용
4. **정기적 검토**: 보안 그룹 규칙의 주기적 감사

---

### 2. 인스턴스 타입 최적화 (ec2-instance-type)

#### 검사 목적
- **주요 목적**: CloudWatch 메트릭 분석을 통한 인스턴스 크기 최적화
- **비용 효율성**: 과다/과소 프로비저닝된 인스턴스 식별

#### 심각도 기준: MEDIUM
**MEDIUM으로 설정한 이유:**
1. **비용 영향**: 직접적인 보안 위험은 아니지만 상당한 비용 절감 효과
2. **성능 영향**: 부적절한 크기는 애플리케이션 성능에 영향
3. **점진적 개선**: 즉시 해결하지 않아도 시스템이 중단되지 않음
4. **측정 가능**: 정량적 지표로 개선 효과 측정 가능

#### 검사 기준
- **FAIL 조건**:
  - 평균 CPU 사용률 < 10% AND 최대 CPU 사용률 < 40% (과다 프로비저닝)
  - 평균 CPU 사용률 > 80% OR 최대 CPU 사용률 > 90% (과소 프로비저닝)
- **분석 기간**: 최근 14일간의 CloudWatch 메트릭 데이터

#### 권장 개선 방안
1. **다운사이징**: CPU 사용률이 지속적으로 낮은 인스턴스
2. **업그레이드**: CPU 사용률이 지속적으로 높은 인스턴스
3. **예약 인스턴스**: 안정적인 워크로드에 대한 비용 절감
4. **Auto Scaling**: 동적 워크로드에 대한 자동 크기 조정

## 검사 실행 프로세스

### 데이터 수집
1. **EC2 인스턴스 정보**: describe_instances API 호출
2. **보안 그룹 정보**: describe_security_groups API 호출
3. **CloudWatch 메트릭**: 14일간의 CPU 사용률 데이터

### 분석 알고리즘
1. **보안 그룹 분석**:
   - 각 인바운드 규칙의 CIDR 블록 검사
   - 위험 포트와 IP 범위 매칭
   - 위험도 점수 계산

2. **인스턴스 크기 분석**:
   - 시간별 CPU 사용률 평균 계산
   - 최대/최소 사용률 추세 분석
   - 인스턴스 타입별 권장사항 생성

### 결과 생성
- **리소스별 상태**: PASS/FAIL/WARNING
- **구체적 권장사항**: 각 리소스에 맞춤형 조치 방안
- **우선순위**: 심각도에 따른 처리 순서

## 모니터링 및 개선

### 지속적 모니터링
- **주기적 검사**: 주 1회 자동 검사 권장
- **변경 감지**: 보안 그룹 규칙 변경 시 즉시 알림
- **트렌드 분석**: 시간에 따른 개선 효과 측정

### 성공 지표
- **보안 개선**: 위험한 보안 그룹 규칙 수 감소
- **비용 절감**: 최적화를 통한 월간 비용 절감액
- **성능 안정성**: CPU 사용률의 적정 범위 유지

## 관련 AWS 서비스

### 보안 강화
- **AWS Systems Manager Session Manager**: SSH 대체 솔루션
- **AWS VPN**: 안전한 원격 접근
- **AWS CloudTrail**: 보안 그룹 변경 감사

### 비용 최적화
- **AWS Cost Explorer**: 비용 분석 및 예측
- **AWS Trusted Advisor**: 추가적인 최적화 권장사항
- **AWS Compute Optimizer**: ML 기반 인스턴스 크기 권장

이 문서는 EC2 서비스 어드바이저의 검사항목이 왜 필요한지, 어떤 기준으로 심각도를 설정했는지에 대한 상세한 설명을 제공합니다.