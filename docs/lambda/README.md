# Lambda (서버리스 함수 관리)

### 1. 메모리 설정 검사
- **조건**: Lambda 함수의 메모리가 512MB 초과일 때
- **심각도**: 낮음
- **메시지**: "Lambda 함수의 메모리 설정을 점검하세요."
- **문제점**: "Lambda 함수의 메모리가 {memory}MB로 설정되어 있습니다."
- **영향**: "필요 이상의 메모리 할당으로 인해 불필요한 비용이 발생할 수 있습니다."
- **혜택**: "적절한 메모리 설정을 통해 비용을 절감할 수 있습니다."
- **권장 조치**:
  - CloudWatch Logs에서 실제 메모리 사용량을 확인합니다.
  - AWS Lambda 콘솔에서 함수 구성을 편집합니다.
  - 메모리 할당을 실제 사용량에 맞게 조정합니다.
  - 변경 후 함수 성능을 모니터링합니다.

### 2. 타임아웃 설정 검사
- **조건**: Lambda 함수의 타임아웃이 60초 초과일 때
- **심각도**: 중간
- **메시지**: "Lambda 함수의 타임아웃 설정을 점검하세요."
- **문제점**: "Lambda 함수의 타임아웃이 {timeout}초로 설정되어 있습니다."
- **영향**: "장시간 실행되는 작업은 Lambda에 적합하지 않아 비용 효율성이 떨어질 수 있습니다."
- **혜택**: "적절한 실행 시간 분리로 효율적인 자원 사용이 가능합니다."
- **권장 조치**:
  - CloudWatch Logs에서 실행 시간을 분석합니다.
  - 실행 시간이 길다면 작업을 더 작은 단위로 분할합니다.
  - Step Functions나 ECS, AWS Batch로의 마이그레이션을 검토합니다.

### 3. 런타임 버전 검사
- **조건**: 지원 종료되거나 곧 종료될 런타임 사용 시
- **심각도**: 높음
- **메시지**: "Lambda 함수의 런타임 버전을 점검하세요."
- **문제점**: "지원 종료되거나 곧 종료될 런타임을 사용하고 있습니다."
- **영향**: "보안 업데이트가 제공되지 않아 보안 취약점에 노출될 수 있습니다."
- **혜택**: "최신 런타임으로의 업그레이드를 통해 보안성과 안정성을 확보할 수 있습니다."
- **권장 조치**:
  - 함수 코드의 호환성을 검토합니다.
  - 새 런타임에서 테스트를 진행합니다.
  - 필요한 코드 수정을 수행하고 배포합니다.
  - 배포 후 성능과 안정성을 모니터링합니다.

### 4. 코드 크기 검사
- **조건**: Lambda 함수의 코드 크기가 5MB 초과일 때
- **심각도**: 중간
- **메시지**: "Lambda 함수의 코드 크기를 점검하세요."
- **문제점**: "Lambda 함수의 코드 크기가 5MB를 초과합니다."
- **영향**: "콜드 스타트 지연 및 배포 시간이 증가할 수 있습니다."
- **혜택**: "코드 최적화를 통해 함수 응답 시간 및 배포 속도를 개선할 수 있습니다."
- **권장 조치**:
  - 불필요한 의존성과 파일을 제거합니다.
  - 공통 라이브러리는 Lambda Layer로 분리합니다.
  - 코드 최적화를 통해 크기를 줄입니다.
  - 필요 시 기능 단위로 함수 분할을 검토합니다.

### 5. X-Ray 추적 검사
- **조건**: X-Ray 추적이 비활성화된 상태일 때
- **심각도**: 낮음
- **메시지**: "X-Ray 추적 설정을 점검하세요."
- **문제점**: "X-Ray 추적이 비활성화되어 있습니다."
- **영향**: "함수 성능이나 오류 원인을 분석하기 어렵습니다."
- **혜택**: "X-Ray 추적을 통해 성능 병목 및 문제점을 빠르게 식별할 수 있습니다."
- **권장 조치**:
  - Lambda 콘솔에서 함수 구성을 편집합니다.
  - 모니터링 설정에서 X-Ray를 활성화합니다.
  - 필요한 IAM 권한을 부여합니다.
  - X-Ray 콘솔에서 추적 결과를 확인합니다.

### 6. VPC 구성 검사
- **조건**: Lambda 함수가 VPC에 연결되어 있지 않을 때
- **심각도**: 중간
- **메시지**: "Lambda 함수의 VPC 구성을 점검하세요."
- **문제점**: "Lambda 함수가 VPC 없이 실행되고 있습니다."
- **영향**: "보안상 민감한 리소스에 접근이 제한되며, 네트워크 격리가 불완전할 수 있습니다."
- **혜택**: "VPC 구성을 통해 리소스 접근 제어 및 네트워크 보안을 강화할 수 있습니다."
- **권장 조치**:
  - 함수가 접근해야 하는 리소스를 파악합니다.
  - 적절한 VPC, 서브넷, 보안 그룹을 선택합니다.
  - 필요한 경우 VPC 엔드포인트를 구성합니다.
  - Lambda 함수에 VPC 구성을 적용합니다.

### 7. 환경 변수 암호화 검사
- **조건**: KMS로 환경 변수가 암호화되지 않은 경우
- **심각도**: 높음
- **메시지**: "Lambda 함수의 환경 변수 암호화 설정을 점검하세요."
- **문제점**: "환경 변수가 추가 암호화 없이 저장되어 있습니다."
- **영향**: "환경 변수에 포함된 민감한 정보가 노출될 위험이 있습니다."
- **혜택**: "KMS 암호화를 통해 민감 정보 보호 수준을 향상시킬 수 있습니다."
- **권장 조치**:
  - KMS 키를 생성하거나 기존 키를 선택합니다.
  - Lambda 함수의 환경 변수에 암호화를 적용합니다.
  - 필요한 IAM 권한을 구성합니다.
  - 암호화된 변수 사용 여부를 테스트합니다.

### 8. ARM64 아키텍처 마이그레이션 검사
- **조건**: ARM64 아키텍처를 사용하지 않을 때
- **심각도**: 낮음
- **메시지**: "Lambda 함수의 아키텍처를 점검하세요."
- **문제점**: "x86_64 아키텍처에서 실행되고 있습니다."
- **영향**: "ARM64 아키텍처 대비 비용 효율성이 낮습니다."
- **혜택**: "ARM64 사용 시 비용 절감 및 성능 개선이 가능합니다."
- **권장 조치**:
  - ARM64 아키텍처와의 코드 호환성을 검토합니다.
  - 테스트 환경에서 ARM64 아키텍처로 실행해 봅니다.
  - 종속성 라이브러리를 ARM64에 맞게 준비합니다.
  - 프로덕션 환경으로 점진적 마이그레이션을 진행합니다.

### 9. 태그 관리 검사
- **조건**: Lambda 함수에 태그가 설정되어 있지 않을 때
- **심각도**: 낮음
- **메시지**: "Lambda 함수의 태그 설정을 점검하세요."
- **문제점**: "Lambda 함수에 태그가 설정되어 있지 않습니다."
- **영향**: "리소스 관리, 비용 분석 및 접근 제어에 어려움이 있습니다."
- **혜택**: "태그를 통해 리소스를 논리적으로 구분하고 효율적인 관리가 가능합니다."
- **권장 조치**:
  - 조직에 맞는 태깅 전략을 수립합니다.
  - 필수 태그 키와 값을 정의합니다.
  - Lambda 콘솔 또는 CLI에서 태그를 추가합니다.
  - 태그 기반 정책을 활용하여 접근 제어를 설정합니다.

### 10. 공개된 Lambda URL 엔드포인트 검사
- **조건**: Lambda 함수가 Lambda URL 기능을 사용 중이며 인증이 비활성화되어 있는 경우
- **심각도**: 높음
- **메시지**: "Lambda URL의 공개 접근 설정을 점검하세요."
- **문제점**: "Lambda 함수가 인증 없이 누구나 접근 가능한 URL을 통해 호출될 수 있습니다."
- **영향**: "공격자에 의한 오용 또는 무단 접근으로 인해 보안 위협이 발생할 수 있습니다."
- **혜택**: "Lambda URL에 인증을 설정함으로써 외부 접근을 안전하게 제한할 수 있습니다."
- **권장 조치**:
  - Lambda URL 구성을 확인합니다.
  - 인증 유형이 'AWS_IAM'으로 설정되어 있는지 확인합니다.
  - IAM 정책을 통해 필요한 사용자에게만 접근 권한을 부여합니다.
  - 인증되지 않은 공개 접근을 즉시 차단합니다.

### 11. 퍼블릭 Layer 사용 검사
- **조건**: 외부에서 만든 퍼블릭 Lambda Layer를 사용하는 경우
- **심각도**: 중간
- **메시지**: "Lambda 함수에서 사용 중인 Layer를 검토하세요."
- **문제점**: "외부 퍼블릭 Layer 사용 시 악성 코드나 알려지지 않은 코드가 포함되어 있을 수 있습니다."
- **영향**: "보안 취약점 또는 예기치 않은 동작의 위험이 있습니다."
- **혜택**: "신뢰할 수 있는 내부 Layer 또는 검증된 Layer를 사용함으로써 보안성을 확보할 수 있습니다."
- **권장 조치**:
  - Lambda Layer ARN이 조직 내부 소유인지 확인합니다.
  - 외부 소유 Layer의 코드를 검토하거나 사용을 중단합니다.
  - 필요한 경우 자체 Layer를 빌드하여 배포합니다.

### 12. 디버깅 로그 출력 검사
- **조건**: 함수 코드 내에 console.log, print 등 디버깅용 로그가 남아 있는 경우
- **심각도**: 낮음
- **메시지**: "디버깅 로그 출력을 점검하세요."
- **문제점**: "디버깅용 로그가 과도하게 출력되고 있습니다."
- **영향**: "CloudWatch Logs 비용 증가 및 민감한 정보 노출 가능성이 있습니다."
- **혜택**: "불필요한 로그 제거를 통해 운영 효율성과 보안을 강화할 수 있습니다."
- **권장 조치**:
  - 함수 코드에서 디버깅 로그를 제거하거나 로그 레벨 제어 로직을 도입합니다.
  - 민감한 정보가 로그로 출력되지 않도록 확인합니다.
  - CloudWatch 로그 그룹의 보관 기간을 설정합니다.

### 13. Reserved Concurrency 미설정 검사
- **조건**: Reserved Concurrency 설정이 없는 경우
- **심각도**: 중간
- **메시지**: "Lambda 함수의 동시성 제한 설정을 점검하세요."
- **문제점**: "동시성 제한이 없어 과도한 요청이 발생하면 다른 함수나 시스템에 영향을 줄 수 있습니다."
- **영향**: "예상치 못한 트래픽 증가 시 장애로 이어질 수 있습니다."
- **혜택**: "적절한 동시성 제한으로 서비스 안정성을 확보할 수 있습니다."
- **권장 조치**:
  - 예상되는 최대 트래픽 기반으로 Reserved Concurrency 값을 설정합니다.
  - 다른 핵심 함수의 리소스를 보호하기 위해 제한을 검토합니다.
  - Auto Scaling과 함께 조합 사용을 고려합니다.

### 14. Dead Letter Queue (DLQ) 미설정 검사
- **조건**: 비동기 Lambda 함수에서 DLQ가 설정되어 있지 않은 경우
- **심각도**: 중간
- **메시지**: "Lambda 함수의 실패 처리 구성을 점검하세요."
- **문제점**: "비동기 함수 실패 시 실패 이벤트가 손실될 수 있습니다."
- **영향**: "실패 원인 추적이나 후속 처리가 어려워집니다."
- **혜택**: "DLQ를 통해 실패 이벤트를 저장하고 안정적인 후속 조치가 가능합니다."
- **권장 조치**:
  - SQS 또는 SNS를 DLQ로 설정합니다.
  - IAM 역할에 DLQ 관련 권한을 부여합니다.
  - 실패 이벤트 처리 및 알림 워크플로우를 구성합니다.

### 15. 최신 버전 alias 미사용 검사
- **조건**: 함수가 `$LATEST` 버전만을 사용하고 있을 때
- **심각도**: 낮음
- **메시지**: "Lambda 함수 버전 관리 및 alias 사용을 점검하세요."
- **문제점**: "$LATEST만을 사용하는 경우 변경 추적 및 롤백이 어렵습니다."
- **영향**: "운영 환경에서 예기치 않게 함수가 바뀌는 위험이 있습니다."
- **혜택**: "고정된 버전과 alias 사용을 통해 배포 관리 및 안정성을 강화할 수 있습니다."
- **권장 조치**:
  - 코드 배포 후 Lambda 버전을 고정하여 게시합니다.
  - alias를 생성하여 고정된 버전과 연결합니다.
  - 배포 자동화를 위한 alias 전환 전략을 구성합니다.
